<!DOCTYPE html>
<!--
  Copyright 2010 Google Inc.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.

  Original slides: Marcin Wichary (mwichary@google.com)
  Modifications: Ernest Delgado (ernestd@google.com)
                 Alex Russell (slightlyoff@chromium.org)

  landslide modifications: Adam Zapletal (adamzap@gmail.com)
                           Nicolas Perriault (nperriault@gmail.com)
-->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Lecture 9: Parsing</title>
    <!-- Styles -->
    
    <link rel="stylesheet" media="print" href="theme/css/print.css">
    <link rel="stylesheet" media="screen, projection" href="theme/css/screen.css">
    
    
    <!-- /Styles -->
    <!-- Javascripts -->
    
    <script type="text/javascript" src="theme/js/slides.js"></script>
    
    
    <!-- /Javascripts -->
</head>
<body style="!important;">
  <div id="blank"></div>
  <div class="presentation">
    <div id="current_presenter_notes">
      <div id="presenter_note"></div>
    </div>
    <div class="slides">
      
      <!-- slide source: lecture9.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Lecture 9: Parsing</h1></header>
            
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>


          <footer>
            
            <aside class="source">
              Source: <a href="lecture9.md">lecture9.md</a>
            </aside>
            
            <aside class="page_number">
              1/36
            </aside>

          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture9.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            
            <section><p>In this chapter, we develop a top-down, LL parser that can detect context-sensitive grammars.</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>


          <footer>
            
            <aside class="source">
              Source: <a href="lecture9.md">lecture9.md</a>
            </aside>
            
            <aside class="page_number">
              2/36
            </aside>

          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture9.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Parsing</h1></header>
            
            
            <section><blockquote>
<p>A parser is a software component that takes input data (frequently text) and builds a data structure – often some kind of parse tree, abstract syntax tree or other hierarchical structure – giving a structural representation of the input, checking for correct syntax in the process.</p>
</blockquote>
<p><a href="https://en.wikipedia.org/wiki/Parsing#Computer_languages">Wikipedia</a></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>


          <footer>
            
            <aside class="source">
              Source: <a href="lecture9.md">lecture9.md</a>
            </aside>
            
            <aside class="page_number">
              3/36
            </aside>

          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture9.md -->
      <div class="slide-wrapper">
        <div class="slide has_code">
          <div class="inner">
            
            <header><h1><code>Parser[+A]</code></h1></header>
            
            
            <section><div class="highlight"><pre><span></span><span class="k">type</span> <span class="kt">Parser</span><span class="o">[</span><span class="kt">+A</span><span class="o">]</span> <span class="k">=</span> 
  <span class="nc">Location</span> <span class="k">=&gt;</span> <span class="nc">XorErrors</span><span class="o">[</span><span class="kt">String</span>, <span class="o">(</span><span class="kt">A</span>, <span class="kt">Int</span><span class="o">)]</span>
</pre></div>

<p><br />
<br /></p>
<p>Developed from the same functional design concepts that gave us:</p>
<div class="highlight"><pre><span></span><span class="k">type</span> <span class="kt">Rand</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=</span> <span class="nc">RNG</span> <span class="k">=&gt;</span> <span class="o">(</span><span class="n">A</span><span class="o">,</span> <span class="nc">RNG</span><span class="o">)</span>
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>


          <footer>
            
            <aside class="source">
              Source: <a href="lecture9.md">lecture9.md</a>
            </aside>
            
            <aside class="page_number">
              4/36
            </aside>

          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture9.md -->
      <div class="slide-wrapper">
        <div class="slide has_code has_notes">
          <div class="inner">
            
            <header><h1>Input to <code>Parser[+A]</code></h1></header>
            
            
            <section><div class="highlight"><pre><span></span><span class="k">case</span> <span class="k">class</span> <span class="nc">Location</span><span class="o">(</span>
  <span class="n">input</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">offset</span><span class="k">:</span> <span class="kt">Integer</span><span class="o">)</span> <span class="o">{</span>
  <span class="o">...</span>
<span class="o">}</span>
</pre></div>

<p><br />
<br /></p>
<p>A <code>Parser[+A]</code> will scan its input from a given offset.</p>
<p><code>Location("foobar", 3)</code> -- a <code>Parser</code> will look at "bar".</p>
<p><br /></p>
<p>This contrasts with an alternative approach that makes <code>offset</code> unnecessary: cutting down the input string.  Then the <code>Parser</code>'s feedback is less informative.</p>
<p class="notes">Alternative - cutting off the consumed characters of the string and passing along the tail. The first part of the string is lost if an error occurs down the line.</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>


          <footer>
            
            <aside class="source">
              Source: <a href="lecture9.md">lecture9.md</a>
            </aside>
            
            <aside class="page_number">
              5/36
            </aside>

          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture9.md -->
      <div class="slide-wrapper">
        <div class="slide has_code">
          <div class="inner">
            
            <header><h1>Output from <code>Parser[+A]</code></h1></header>
            
            
            <section><p>Left: Parser rejects input</p>
<p>Right: Parser accepts input</p>
<div class="highlight"><pre><span></span><span class="nc">XorErrors</span><span class="o">[</span><span class="kt">String</span>, <span class="o">(</span><span class="kt">A</span>, <span class="kt">Int</span><span class="o">)]</span>

<span class="c1">// equivalent to</span>

<span class="nc">Xor</span><span class="o">[</span><span class="kt">NonEmptyList</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span>, <span class="o">(</span><span class="kt">A</span>, <span class="kt">Int</span><span class="o">)]</span>
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>


          <footer>
            
            <aside class="source">
              Source: <a href="lecture9.md">lecture9.md</a>
            </aside>
            
            <aside class="page_number">
              6/36
            </aside>

          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture9.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Left: Parser rejects input</h1></header>
            
            
            <section><p>Inside <code>Left</code>:</p>
<p><code>NonEmptyList[String]</code> accumulates errors.  </p>
<p>These <code>String</code>s should explain why <code>Parser[+A]</code> rejected its input.</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>


          <footer>
            
            <aside class="source">
              Source: <a href="lecture9.md">lecture9.md</a>
            </aside>
            
            <aside class="page_number">
              7/36
            </aside>

          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture9.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Right: Parser accepts input</h1></header>
            
            
            <section><p>Inside <code>Right</code>:</p>
<p><code>(A, Int)</code> holds a <em>token</em> of type <code>A</code> and the number of characters consumed to create this token.</p>
<p>We will develop various types of <em>token</em>.</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>


          <footer>
            
            <aside class="source">
              Source: <a href="lecture9.md">lecture9.md</a>
            </aside>
            
            <aside class="page_number">
              8/36
            </aside>

          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture9.md -->
      <div class="slide-wrapper">
        <div class="slide has_code">
          <div class="inner">
            
            <header><h1>A <code>Parser</code> Primitive</h1></header>
            
            
            <section><p>Here, the <em>token</em> is a <code>String</code>. </p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="n">string</span><span class="o">(</span><span class="n">detect</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span><span class="k">:</span> <span class="kt">Parser</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span>
  <span class="o">(</span><span class="n">loc</span><span class="k">:</span> <span class="kt">Location</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="o">{</span>
  <span class="k">val</span> <span class="n">matches</span><span class="k">:</span> <span class="kt">Boolean</span> <span class="o">=</span>
    <span class="n">detect</span><span class="o">.</span><span class="n">regionMatches</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">loc</span><span class="o">.</span><span class="n">input</span><span class="o">,</span> 
      <span class="n">loc</span><span class="o">.</span><span class="n">offset</span><span class="o">,</span> <span class="n">detect</span><span class="o">.</span><span class="n">length</span><span class="o">())</span>
  <span class="k">if</span><span class="o">(</span><span class="n">matches</span><span class="o">)</span>
    <span class="nc">Right</span><span class="o">((</span><span class="n">detect</span><span class="o">,</span> <span class="n">detect</span><span class="o">.</span><span class="n">length</span><span class="o">()))</span>
  <span class="k">else</span> 
    <span class="nc">Left</span><span class="o">(</span><span class="nc">NonEmptyList</span><span class="o">(</span>
      <span class="s">s&quot;</span><span class="si">$detect</span><span class="s"> not in </span><span class="si">${</span><span class="n">loc</span><span class="o">.</span><span class="n">input</span><span class="si">}</span><span class="s"> </span>
<span class="s">      at offset </span><span class="si">${</span><span class="n">loc</span><span class="o">.</span><span class="n">offset</span><span class="si">}</span><span class="s">&quot;</span>
      <span class="o">))</span>
<span class="o">}</span>
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>


          <footer>
            
            <aside class="source">
              Source: <a href="lecture9.md">lecture9.md</a>
            </aside>
            
            <aside class="page_number">
              9/36
            </aside>

          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture9.md -->
      <div class="slide-wrapper">
        <div class="slide has_code">
          <div class="inner">
            
            <header><h1><code>run</code></h1></header>
            
            
            <section><p>Our <code>Parser</code>s require a <code>Location</code> as input.  This wraps the input in a <code>Location</code>.</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="n">run</span><span class="o">[</span><span class="kt">A</span><span class="o">](</span><span class="n">parserA</span><span class="k">:</span> <span class="kt">Parser</span><span class="o">[</span><span class="kt">A</span><span class="o">])(</span><span class="n">input</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span><span class="k">:</span> 
  <span class="kt">XorErrors</span><span class="o">[</span><span class="kt">String</span>, <span class="o">(</span><span class="kt">A</span>, <span class="kt">Int</span><span class="o">)]</span> <span class="k">=</span>
  <span class="n">parserA</span><span class="o">(</span><span class="nc">Location</span><span class="o">(</span><span class="n">input</span><span class="o">,</span><span class="mi">0</span><span class="o">))</span>
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>


          <footer>
            
            <aside class="source">
              Source: <a href="lecture9.md">lecture9.md</a>
            </aside>
            
            <aside class="page_number">
              10/36
            </aside>

          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture9.md -->
      <div class="slide-wrapper">
        <div class="slide has_code">
          <div class="inner">
            
            
            <section><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">detectFoo</span><span class="k">:</span> <span class="kt">Parser</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="n">string</span><span class="o">(</span><span class="s">&quot;foo&quot;</span><span class="o">)</span>
<span class="k">val</span> <span class="n">document</span> <span class="k">=</span> <span class="s">&quot;foobar&quot;</span>
<span class="k">val</span> <span class="n">resultFoo</span><span class="k">:</span> 
  <span class="kt">XorErrors</span><span class="o">[</span><span class="kt">String</span>, <span class="o">(</span><span class="kt">String</span>, <span class="kt">Int</span><span class="o">)]</span> <span class="k">=</span>
  <span class="n">run</span><span class="o">(</span><span class="n">detectFoo</span><span class="o">)(</span><span class="n">document</span><span class="o">)</span>

<span class="c1">// `parserResultToString` </span>
<span class="c1">// formats the output `Xor` nicely</span>
<span class="n">println</span><span class="o">(</span><span class="n">parserResultToString</span><span class="o">(</span><span class="n">resultFoo</span><span class="o">))</span>
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>


          <footer>
            
            <aside class="source">
              Source: <a href="lecture9.md">lecture9.md</a>
            </aside>
            
            <aside class="page_number">
              11/36
            </aside>

          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture9.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            
            <section><pre><code>[info] Running slideCode.lecture9.SimpleParser...
document
foobar
detect 'foo'
Right: Accept.  token tree = foo  | 
                chars consumed = 3
</code></pre>
<p><br /></p>
<p>We need an "end of field" Parser; equivalent to the <code>$</code> or <code>\z</code> regular expression.</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>


          <footer>
            
            <aside class="source">
              Source: <a href="lecture9.md">lecture9.md</a>
            </aside>
            
            <aside class="page_number">
              12/36
            </aside>

          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture9.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Compatibility with Scala's <a href="http://www.scala-lang.org/api/2.11.8/#scala.util.matching.Regex"><code>Regex</code></a> type</h1></header>
            
            
            <section><pre><code>scala&gt; "\\z".r
res1: scala.util.matching.Regex = \z

scala&gt; "\\z".r.regex 
res2: String = \z
</code></pre></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>


          <footer>
            
            <aside class="source">
              Source: <a href="lecture9.md">lecture9.md</a>
            </aside>
            
            <aside class="page_number">
              13/36
            </aside>

          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture9.md -->
      <div class="slide-wrapper">
        <div class="slide has_code">
          <div class="inner">
            
            <header><h1>Compatibility with Scala's <code>Regex</code> type</h1></header>
            
            
            <section><div class="highlight"><pre><span></span><span class="c1">// input example: &quot;\\z&quot;.r</span>
<span class="k">def</span> <span class="n">regex</span><span class="o">(</span><span class="n">r</span><span class="k">:</span> <span class="kt">Regex</span><span class="o">)</span><span class="k">:</span> <span class="kt">Parser</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span>
  <span class="n">string</span><span class="o">(</span><span class="n">r</span><span class="o">.</span><span class="n">regex</span><span class="o">)</span>
</pre></div>

<p><code>regex</code> constructs a <code>Parser[String]</code> that will accept a given Scala <code>Regex</code></p>
<div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">eof</span><span class="k">:</span> <span class="kt">Parser</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span>
  <span class="n">regex</span><span class="o">(</span><span class="s">&quot;\\z&quot;</span><span class="o">.</span><span class="n">r</span><span class="o">)</span>
</pre></div>

<p>Now we have an "end of field" Parser, equivalent to "$"</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>


          <footer>
            
            <aside class="source">
              Source: <a href="lecture9.md">lecture9.md</a>
            </aside>
            
            <aside class="page_number">
              14/36
            </aside>

          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture9.md -->
      <div class="slide-wrapper">
        <div class="slide has_code">
          <div class="inner">
            
            <header><h1>How to combine <code>detectFoo</code> and <code>eof</code>?</h1></header>
            
            
            <section><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">detectFoo</span><span class="k">:</span> <span class="kt">Parser</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="n">string</span><span class="o">(</span><span class="s">&quot;foo&quot;</span><span class="o">)</span>
<span class="k">val</span> <span class="n">eof</span><span class="k">:</span> <span class="kt">Parser</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="n">regex</span><span class="o">(</span><span class="s">&quot;\\z&quot;</span><span class="o">.</span><span class="n">r</span><span class="o">)</span>
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>


          <footer>
            
            <aside class="source">
              Source: <a href="lecture9.md">lecture9.md</a>
            </aside>
            
            <aside class="page_number">
              15/36
            </aside>

          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture9.md -->
      <div class="slide-wrapper">
        <div class="slide has_code">
          <div class="inner">
            
            <header><h1><code>product</code></h1></header>
            
            
            <section><p><code>product</code> puts two parsers in sequence.  </p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="n">product</span><span class="o">[</span><span class="kt">A</span>,<span class="kt">B</span><span class="o">](</span><span class="n">parserA</span><span class="k">:</span> <span class="kt">Parser</span><span class="o">[</span><span class="kt">A</span><span class="o">],</span> 
                 <span class="n">parserB</span><span class="k">:</span> <span class="o">=&gt;</span> <span class="nc">Parser</span><span class="o">[</span><span class="kt">B</span><span class="o">])</span><span class="k">:</span> 
  <span class="kt">Parser</span><span class="o">[(</span><span class="kt">A</span>,<span class="kt">B</span><span class="o">)]</span> <span class="k">=</span> <span class="o">{</span>
  <span class="k">def</span> <span class="n">f</span><span class="o">(</span><span class="n">a</span><span class="k">:</span> <span class="kt">A</span><span class="o">,</span> <span class="n">b</span><span class="k">:</span> <span class="o">=&gt;</span> <span class="n">B</span><span class="o">)</span><span class="k">:</span> <span class="o">(</span><span class="kt">A</span><span class="o">,</span><span class="kt">B</span><span class="o">)</span> <span class="k">=</span> <span class="o">(</span><span class="n">a</span><span class="o">,</span><span class="n">b</span><span class="o">)</span>
  <span class="n">map2</span><span class="o">(</span><span class="n">parserA</span><span class="o">,</span> <span class="n">parserB</span><span class="o">)(</span><span class="n">f</span><span class="o">)</span>
<span class="o">}</span>
</pre></div>

<p>If both parsers accept their input, they will produce tokens <code>A</code> and <code>B</code>.</p>
<p><code>Parser[A]</code> consumes as much as it needs to, then sets the <code>offset</code> for <code>Parser[B]</code>.</p>
<p><br />
<br /></p>
<p><code>map2</code> and its dependencies will be shown later.</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>


          <footer>
            
            <aside class="source">
              Source: <a href="lecture9.md">lecture9.md</a>
            </aside>
            
            <aside class="page_number">
              16/36
            </aside>

          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture9.md -->
      <div class="slide-wrapper">
        <div class="slide has_code">
          <div class="inner">
            
            
            <section><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">detectFooEOF</span> <span class="k">=</span> <span class="n">product</span><span class="o">(</span><span class="n">detectFoo</span><span class="o">,</span> <span class="n">eof</span><span class="o">)</span>

<span class="k">val</span> <span class="n">resultFooEOF</span> <span class="k">=</span> <span class="n">run</span><span class="o">(</span><span class="n">detectFooEOF</span><span class="o">)(</span><span class="n">document</span><span class="o">)</span>

<span class="n">println</span><span class="o">(</span><span class="n">parserResultToString</span><span class="o">(</span><span class="n">resultFooEOF</span><span class="o">))</span>
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>


          <footer>
            
            <aside class="source">
              Source: <a href="lecture9.md">lecture9.md</a>
            </aside>
            
            <aside class="page_number">
              17/36
            </aside>

          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture9.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Rejection</h1></header>
            
            
            <section><pre><code>document
foobar
detect 'foo' with end-of-field
Left: Reject. 
      Parse errors: \z not in foobar at offset 3
</code></pre></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>


          <footer>
            
            <aside class="source">
              Source: <a href="lecture9.md">lecture9.md</a>
            </aside>
            
            <aside class="page_number">
              18/36
            </aside>

          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture9.md -->
      <div class="slide-wrapper">
        <div class="slide has_code">
          <div class="inner">
            
            <header><h1>Combinators</h1></header>
            
            
            <section><div class="highlight"><pre><span></span><span class="k">def</span> <span class="n">flatMap</span><span class="o">[</span><span class="kt">A</span>,<span class="kt">B</span><span class="o">](</span><span class="n">parserA</span><span class="k">:</span> <span class="kt">Parser</span><span class="o">[</span><span class="kt">A</span><span class="o">])</span>
  <span class="o">(</span><span class="n">aParserB</span><span class="k">:</span> <span class="kt">A</span> <span class="o">=&gt;</span> <span class="nc">Parser</span><span class="o">[</span><span class="kt">B</span><span class="o">])</span><span class="k">:</span> <span class="kt">Parser</span><span class="o">[</span><span class="kt">B</span><span class="o">]</span> <span class="k">=</span> <span class="o">...</span>

<span class="k">def</span> <span class="n">map</span><span class="o">[</span><span class="kt">A</span>,<span class="kt">B</span><span class="o">](</span><span class="n">parserA</span><span class="k">:</span> <span class="kt">Parser</span><span class="o">[</span><span class="kt">A</span><span class="o">])</span>
            <span class="o">(</span><span class="n">f</span><span class="k">:</span> <span class="kt">A</span> <span class="o">=&gt;</span> <span class="n">B</span><span class="o">)</span><span class="k">:</span> <span class="kt">Parser</span><span class="o">[</span><span class="kt">B</span><span class="o">]</span> <span class="k">=</span> <span class="o">...</span>

<span class="k">def</span> <span class="n">map2</span><span class="o">[</span><span class="kt">A</span>,<span class="kt">B</span>,<span class="kt">C</span><span class="o">](</span><span class="n">parserA</span><span class="k">:</span> <span class="kt">Parser</span><span class="o">[</span><span class="kt">A</span><span class="o">],</span> 
                <span class="n">parserB</span><span class="k">:</span> <span class="o">=&gt;</span> <span class="nc">Parser</span><span class="o">[</span><span class="kt">B</span><span class="o">])</span>
                <span class="o">(</span><span class="n">f</span><span class="k">:</span> <span class="o">(</span><span class="kt">A</span><span class="o">,=&gt;</span><span class="n">B</span><span class="o">)</span><span class="k">=&gt;</span><span class="n">C</span><span class="o">)</span><span class="k">:</span> <span class="kt">Parser</span><span class="o">[</span><span class="kt">C</span><span class="o">]</span> <span class="k">=</span> <span class="o">...</span>
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>


          <footer>
            
            <aside class="source">
              Source: <a href="lecture9.md">lecture9.md</a>
            </aside>
            
            <aside class="page_number">
              19/36
            </aside>

          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture9.md -->
      <div class="slide-wrapper">
        <div class="slide has_code">
          <div class="inner">
            
            <header><h1>Analogies to <code>Rand</code></h1></header>
            
            
            <section><p>Recall that <code>unit</code> for <code>Rand</code> always generated the same "random" value.</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="n">unit</span><span class="o">[</span><span class="kt">A</span><span class="o">](</span><span class="n">a</span><span class="k">:</span> <span class="kt">A</span><span class="o">)</span><span class="k">:</span> <span class="kt">Rand</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=</span>
  <span class="n">rng</span> <span class="k">=&gt;</span> <span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">rng</span><span class="o">)</span>
</pre></div>

<p>Analogously, <code>unit</code> for <code>Parser</code> always <em>accepts</em>.</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="n">succeed</span><span class="o">[</span><span class="kt">A</span><span class="o">](</span><span class="n">a</span><span class="k">:</span> <span class="kt">A</span><span class="o">)</span><span class="k">:</span> <span class="kt">Parser</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=</span>
  <span class="o">(</span><span class="n">loc</span><span class="k">:</span> <span class="kt">Location</span><span class="o">)</span> <span class="k">=&gt;</span>  <span class="nc">Right</span><span class="o">((</span><span class="n">a</span><span class="o">,</span> <span class="mi">0</span><span class="o">))</span>

<span class="k">def</span> <span class="n">unit</span><span class="o">[</span><span class="kt">A</span><span class="o">](</span><span class="n">a</span><span class="k">:</span> <span class="kt">A</span><span class="o">)</span><span class="k">:</span> <span class="kt">Parser</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=</span> <span class="n">succeed</span><span class="o">(</span><span class="n">a</span><span class="o">)</span>
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>


          <footer>
            
            <aside class="source">
              Source: <a href="lecture9.md">lecture9.md</a>
            </aside>
            
            <aside class="page_number">
              20/36
            </aside>

          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture9.md -->
      <div class="slide-wrapper">
        <div class="slide has_code">
          <div class="inner">
            
            <header><h1>Analogies to <code>Rand</code></h1></header>
            
            
            <section><p>Recall that with the use of the <code>Rand</code> combinators, </p>
<p><code>RNG</code> was passed <em>implicitly</em>.  One fewer place to make an error -- mishandling <code>RNG</code>.</p>
<div class="highlight"><pre><span></span><span class="k">type</span> <span class="kt">Rand</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=</span> <span class="nc">RNG</span> <span class="k">=&gt;</span> <span class="o">(</span><span class="n">A</span><span class="o">,</span> <span class="nc">RNG</span><span class="o">)</span>
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>


          <footer>
            
            <aside class="source">
              Source: <a href="lecture9.md">lecture9.md</a>
            </aside>
            
            <aside class="page_number">
              21/36
            </aside>

          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture9.md -->
      <div class="slide-wrapper">
        <div class="slide has_code">
          <div class="inner">
            
            
            <section><p>In <code>Parser</code>,</p>
<p><code>Location(input, offset)</code> is passed implicitly.</p>
<div class="highlight"><pre><span></span><span class="k">type</span> <span class="kt">Parser</span><span class="o">[</span><span class="kt">+A</span><span class="o">]</span> <span class="k">=</span>
  <span class="nc">Location</span> <span class="k">=&gt;</span> <span class="nc">XorErrors</span><span class="o">[</span><span class="kt">String</span>, <span class="o">(</span><span class="kt">A</span>, <span class="kt">Int</span><span class="o">)]</span>
</pre></div>

<p>The right side of the <code>Xor</code> is used to increment the <code>Location</code> -- consuming characters of the input string.    </p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="n">advanceParserResult</span><span class="o">[</span><span class="kt">A</span><span class="o">](</span>
  <span class="n">xor</span><span class="k">:</span> <span class="kt">XorErrors</span><span class="o">[</span><span class="kt">String</span>,<span class="o">(</span><span class="kt">A</span>,<span class="kt">Int</span><span class="o">)],</span> <span class="n">consumed</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span><span class="k">:</span>
  <span class="kt">XorErrors</span><span class="o">[</span><span class="kt">String</span>, <span class="o">(</span><span class="kt">A</span>, <span class="kt">Int</span><span class="o">)]</span> <span class="k">=</span> <span class="o">...</span>
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>


          <footer>
            
            <aside class="source">
              Source: <a href="lecture9.md">lecture9.md</a>
            </aside>
            
            <aside class="page_number">
              22/36
            </aside>

          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture9.md -->
      <div class="slide-wrapper">
        <div class="slide has_code">
          <div class="inner">
            
            
            <section><p>We mentioned earlier: </p>
<p>"<code>Parser[A]</code> consumes as much as it needs to, then sets the <code>offset</code> for <code>Parser[B]</code>."</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="n">product</span><span class="o">[</span><span class="kt">A</span>,<span class="kt">B</span><span class="o">](</span><span class="n">parserA</span><span class="k">:</span> <span class="kt">Parser</span><span class="o">[</span><span class="kt">A</span><span class="o">],</span> 
                 <span class="n">parserB</span><span class="k">:</span> <span class="o">=&gt;</span> <span class="nc">Parser</span><span class="o">[</span><span class="kt">B</span><span class="o">])</span><span class="k">:</span> 
  <span class="kt">Parser</span><span class="o">[(</span><span class="kt">A</span>,<span class="kt">B</span><span class="o">)]</span> <span class="k">=</span> <span class="o">{</span>
  <span class="k">def</span> <span class="n">f</span><span class="o">(</span><span class="n">a</span><span class="k">:</span> <span class="kt">A</span><span class="o">,</span> <span class="n">b</span><span class="k">:</span> <span class="o">=&gt;</span> <span class="n">B</span><span class="o">)</span><span class="k">:</span> <span class="o">(</span><span class="kt">A</span><span class="o">,</span><span class="kt">B</span><span class="o">)</span> <span class="k">=</span> <span class="o">(</span><span class="n">a</span><span class="o">,</span><span class="n">b</span><span class="o">)</span>
  <span class="n">map2</span><span class="o">(</span><span class="n">parserA</span><span class="o">,</span> <span class="n">parserB</span><span class="o">)(</span><span class="n">f</span><span class="o">)</span>
<span class="o">}</span>
</pre></div>

<p>Do you see <code>Location</code> or <code>offset</code> anywhere in here?  It is passed <em>implicitly</em>. </p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>


          <footer>
            
            <aside class="source">
              Source: <a href="lecture9.md">lecture9.md</a>
            </aside>
            
            <aside class="page_number">
              23/36
            </aside>

          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture9.md -->
      <div class="slide-wrapper">
        <div class="slide has_code">
          <div class="inner">
            
            <header><h1>or</h1></header>
            
            
            <section><div class="highlight"><pre><span></span><span class="k">def</span> <span class="n">or</span><span class="o">[</span><span class="kt">A</span><span class="o">](</span><span class="n">p1</span><span class="k">:</span> <span class="kt">Parser</span><span class="o">[</span><span class="kt">A</span><span class="o">],</span> <span class="n">p2</span><span class="k">:</span> <span class="o">=&gt;</span> <span class="nc">Parser</span><span class="o">[</span><span class="kt">A</span><span class="o">])</span><span class="k">:</span> 
  <span class="kt">Parser</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=</span> <span class="o">...</span>
</pre></div>

<p><code>or</code> is our first clue that we are building an <em>LL Parser</em>, for the <em>leftmost</em> accepted derivation of the syntax tree.</p>
<p>We give priority to the left input of <code>or</code>.</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>


          <footer>
            
            <aside class="source">
              Source: <a href="lecture9.md">lecture9.md</a>
            </aside>
            
            <aside class="page_number">
              24/36
            </aside>

          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture9.md -->
      <div class="slide-wrapper">
        <div class="slide has_code">
          <div class="inner">
            
            <header><h1>Tokens</h1></header>
            
            
            <section><div class="highlight"><pre><span></span><span class="k">sealed</span> <span class="k">trait</span> <span class="nc">Alphabet</span>

<span class="k">case</span> <span class="k">class</span> <span class="nc">X</span><span class="o">(</span><span class="n">nested</span><span class="k">:</span> <span class="kt">Alphabet</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">Alphabet</span>
<span class="k">case</span> <span class="k">class</span> <span class="nc">Y</span><span class="o">(</span><span class="n">nested</span><span class="k">:</span> <span class="kt">Alphabet</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">Alphabet</span>
<span class="k">case</span> <span class="k">object</span> <span class="nc">Z</span> <span class="k">extends</span> <span class="nc">Alphabet</span>
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>


          <footer>
            
            <aside class="source">
              Source: <a href="lecture9.md">lecture9.md</a>
            </aside>
            
            <aside class="page_number">
              25/36
            </aside>

          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture9.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Grammar</h1></header>
            
            
            <section><p>"Start" -&gt; X</p>
<p>X -&gt; xY</p>
<p>Y -&gt; yX | yZ</p>
<p>Z -&gt; z</p>
<h2>Accepted:</h2>
<p>"xyz"         into         <code>X(Y(Z))</code></p>
<p>"xyxyxyz"  into <code>X(Y(X(Y(X(Y(Z))))))</code></p>
<p>"xyxyxyxyxyz"  into <code>X(Y(X(Y(X(Y(X(Y(X(Y(Z))))))))))</code></p>
<h2>Rejected:</h2>
<p>"xxxyyyz"</p>
<p>"xyyyz"</p>
<p>(even though the <code>X</code>, <code>Y</code> and <code>Z</code> tokens can contain these strings)</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>


          <footer>
            
            <aside class="source">
              Source: <a href="lecture9.md">lecture9.md</a>
            </aside>
            
            <aside class="page_number">
              26/36
            </aside>

          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture9.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            
            <section><pre><code>document: xyxyxyxyz
Right: Accept.  
  token tree = X(Y(X(Y(X(Y(X(Y(Z))))))))  
  chars consumed = 9

------------

document: xyyyxyz
Left: Reject. 
  Parse errors: 
    x not in xyyyxyz at offset 2 
    z not in xyyyxyz at offset 2
</code></pre></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>


          <footer>
            
            <aside class="source">
              Source: <a href="lecture9.md">lecture9.md</a>
            </aside>
            
            <aside class="page_number">
              27/36
            </aside>

          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture9.md -->
      <div class="slide-wrapper">
        <div class="slide has_code">
          <div class="inner">
            
            <header><h1>Another grammar, another set of Tokens</h1></header>
            
            
            <section><div class="highlight"><pre><span></span><span class="k">sealed</span> <span class="k">trait</span> <span class="nc">Alphabet</span>

<span class="k">case</span> <span class="k">class</span> <span class="nc">AC</span><span class="o">(</span><span class="n">nested</span><span class="k">:</span> <span class="kt">Alphabet</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">Alphabet</span> <span class="o">{</span>
  <span class="k">override</span> <span class="k">def</span> <span class="n">toString</span> <span class="k">=</span> <span class="s">&quot;A&quot;</span><span class="o">+</span><span class="n">nested</span><span class="o">.</span><span class="n">toString</span><span class="o">+</span><span class="s">&quot;C&quot;</span>
<span class="o">}</span>
<span class="k">case</span> <span class="k">object</span> <span class="nc">B</span> <span class="k">extends</span> <span class="nc">Alphabet</span> <span class="o">{</span>
  <span class="k">override</span> <span class="k">def</span> <span class="n">toString</span> <span class="k">=</span> <span class="s">&quot;B&quot;</span>
<span class="o">}</span>
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>


          <footer>
            
            <aside class="source">
              Source: <a href="lecture9.md">lecture9.md</a>
            </aside>
            
            <aside class="page_number">
              28/36
            </aside>

          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture9.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Grammar</h1></header>
            
            
            <section><p>"Start" -&gt;  aBc</p>
<p>B -&gt; aBc | b</p>
<h2>Accepted:</h2>
<p>"abc" into <code>AC(B)</code></p>
<p>"aabcc" into <code>AC(AC(B))</code></p>
<h2>Rejected:</h2>
<p>"aaabcc"</p>
<p>"aabbcc"</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>


          <footer>
            
            <aside class="source">
              Source: <a href="lecture9.md">lecture9.md</a>
            </aside>
            
            <aside class="page_number">
              29/36
            </aside>

          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture9.md -->
      <div class="slide-wrapper">
        <div class="slide has_code">
          <div class="inner">
            
            <header><h1>More prerequisite combinators</h1></header>
            
            
            <section><div class="highlight"><pre><span></span><span class="c1">// Sequences two parsers,</span>
<span class="c1">// ignoring the result of the first.</span>
<span class="k">def</span> <span class="n">skipL</span><span class="o">[</span><span class="kt">B</span><span class="o">](</span><span class="n">p</span><span class="k">:</span> <span class="kt">Parser</span><span class="o">[</span><span class="kt">Any</span><span class="o">],</span> <span class="n">p2</span><span class="k">:</span> <span class="o">=&gt;</span> <span class="nc">Parser</span><span class="o">[</span><span class="kt">B</span><span class="o">])</span><span class="k">:</span> 
  <span class="kt">Parser</span><span class="o">[</span><span class="kt">B</span><span class="o">]</span> <span class="k">=</span>
  <span class="n">map2</span><span class="o">(</span><span class="n">p</span><span class="o">,</span> <span class="n">p2</span><span class="o">)((</span><span class="k">_</span><span class="o">,</span><span class="n">b</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">b</span><span class="o">)</span>

<span class="c1">// Sequences two parsers, </span>
<span class="c1">// ignoring the result of the second.</span>
<span class="k">def</span> <span class="n">skipR</span><span class="o">[</span><span class="kt">A</span><span class="o">](</span><span class="n">p</span><span class="k">:</span> <span class="kt">Parser</span><span class="o">[</span><span class="kt">A</span><span class="o">],</span> <span class="n">p2</span><span class="k">:</span> <span class="o">=&gt;</span> <span class="nc">Parser</span><span class="o">[</span><span class="kt">Any</span><span class="o">])</span><span class="k">:</span> 
  <span class="kt">Parser</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=</span>
  <span class="n">map2</span><span class="o">(</span><span class="n">p</span><span class="o">,</span> <span class="n">p2</span><span class="o">)((</span><span class="n">a</span><span class="o">,</span><span class="k">_</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">a</span><span class="o">)</span>
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>


          <footer>
            
            <aside class="source">
              Source: <a href="lecture9.md">lecture9.md</a>
            </aside>
            
            <aside class="page_number">
              30/36
            </aside>

          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture9.md -->
      <div class="slide-wrapper">
        <div class="slide has_code">
          <div class="inner">
            
            <header><h1>More prerequisite combinators</h1></header>
            
            
            <section><div class="highlight"><pre><span></span><span class="k">def</span> <span class="n">surround</span><span class="o">[</span><span class="kt">A</span><span class="o">](</span><span class="n">left</span><span class="k">:</span> <span class="kt">Parser</span><span class="o">[</span><span class="kt">Any</span><span class="o">],</span> 
                <span class="n">right</span><span class="k">:</span> <span class="kt">Parser</span><span class="o">[</span><span class="kt">Any</span><span class="o">])</span>
               <span class="o">(</span><span class="n">middle</span><span class="k">:</span> <span class="o">=&gt;</span> <span class="nc">Parser</span><span class="o">[</span><span class="kt">A</span><span class="o">])</span><span class="k">:</span> <span class="kt">Parser</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="k">=</span>
  <span class="n">skipL</span><span class="o">(</span><span class="n">left</span><span class="o">,</span> <span class="n">skipR</span><span class="o">(</span><span class="n">middle</span><span class="o">,</span> <span class="n">right</span><span class="o">))</span>

<span class="c1">// necessary for &quot;aBc&quot;</span>
</pre></div>
</section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>


          <footer>
            
            <aside class="source">
              Source: <a href="lecture9.md">lecture9.md</a>
            </aside>
            
            <aside class="page_number">
              31/36
            </aside>

          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture9.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            
            <section><p>Parsing without EOF at end</p>
<pre><code>[info] Running slideCode.lecture9.ABC 
document: abc

Right: Accept.  token tree = ABC  |
       chars consumed = 3

---------------------------
document: abcccc
Right: Accept.  token tree = ABC  | 
       chars consumed = 3
</code></pre></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>


          <footer>
            
            <aside class="source">
              Source: <a href="lecture9.md">lecture9.md</a>
            </aside>
            
            <aside class="page_number">
              32/36
            </aside>

          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture9.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            
            <section><p>Parsing with EOF at end</p>
<pre><code>document: abcccc
Left: Reject. Parse errors: \z not in abcccc 
              at offset 3

---------------------------
document: aaabccc
Right: Accept.  token tree = AAABCCC  | 
                chars consumed = 7
</code></pre></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>


          <footer>
            
            <aside class="source">
              Source: <a href="lecture9.md">lecture9.md</a>
            </aside>
            
            <aside class="page_number">
              33/36
            </aside>

          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture9.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Conclusion</h1></header>
            
            
            <section><ul>
<li>
<p>We've attempted to emphasize how more complex grammars require more complex combinators</p>
</li>
<li>
<p>Just as complex grammars build on simple grammars, complex combinators build on simple combinators</p>
</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>


          <footer>
            
            <aside class="source">
              Source: <a href="lecture9.md">lecture9.md</a>
            </aside>
            
            <aside class="page_number">
              34/36
            </aside>

          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture9.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Chapter comments</h1></header>
            
            
            <section><ul>
<li>
<p>The chapter is primarily about functional design</p>
</li>
<li>
<p>It is a difficult first introduction to parsing and grammars</p>
</li>
<li>
<p><code>Commiting</code> is an important feature we have omitted.  It gives the user of the parser control over backtracking.</p>
<ul>
<li>Our implementation always backtracks, when possible.</li>
<li>Sometimes its advantageous to block backtracking, and reject.</li>
</ul>
</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>


          <footer>
            
            <aside class="source">
              Source: <a href="lecture9.md">lecture9.md</a>
            </aside>
            
            <aside class="page_number">
              35/36
            </aside>

          </footer>
        </div>
      </div>
      
      <!-- slide source: lecture9.md -->
      <div class="slide-wrapper">
        <div class="slide has_code">
          <div class="inner">
            
            
            <section><p>Our simplified implementation hard-wires a <code>Parser</code> as:</p>
<div class="highlight"><pre><span></span><span class="k">type</span> <span class="kt">Parser</span><span class="o">[</span><span class="kt">+A</span><span class="o">]</span> <span class="k">=</span> 
  <span class="nc">Location</span> <span class="k">=&gt;</span> <span class="nc">XorErrors</span><span class="o">[</span><span class="kt">String</span>, <span class="o">(</span><span class="kt">A</span>, <span class="kt">Int</span><span class="o">)]</span>
</pre></div>

<p>The book's implementation is considerable more complicated.</p>
<p>In the book, the type of <code>Parser</code> changes frequently in the chapter to demonstrate top-down reasoning about possible implementations, and algebraic design.  Different <code>Parser[+A]</code> inputs and outputs are explored.</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>


          <footer>
            
            <aside class="source">
              Source: <a href="lecture9.md">lecture9.md</a>
            </aside>
            
            <aside class="page_number">
              36/36
            </aside>

          </footer>
        </div>
      </div>
      
    </div>
  </div>
  
  <div id="toc" class="sidebar hidden">
    <h2>Table of Contents</h2>
    <table>
      <caption>Table of Contents</caption>
      
      <tr id="toc-row-1">
        <th><a href="#slide1">Lecture 9: Parsing</a></th>
        <td><a href="#slide1">1</a></td>
      </tr>
      
      
      <tr id="toc-row-2">
        <th><a href="#slide2">-</a></th>
        <td><a href="#slide2">2</a></td>
      </tr>
      
      
      <tr id="toc-row-3">
        <th><a href="#slide3">Parsing</a></th>
        <td><a href="#slide3">3</a></td>
      </tr>
      
      
      <tr id="toc-row-4">
        <th><a href="#slide4"><code>Parser[+A]</code></a></th>
        <td><a href="#slide4">4</a></td>
      </tr>
      
      
      <tr id="toc-row-5">
        <th><a href="#slide5">Input to <code>Parser[+A]</code></a></th>
        <td><a href="#slide5">5</a></td>
      </tr>
      
      
      <tr id="toc-row-6">
        <th><a href="#slide6">Output from <code>Parser[+A]</code></a></th>
        <td><a href="#slide6">6</a></td>
      </tr>
      
      
      <tr id="toc-row-7">
        <th><a href="#slide7">Left: Parser rejects input</a></th>
        <td><a href="#slide7">7</a></td>
      </tr>
      
      
      <tr id="toc-row-8">
        <th><a href="#slide8">Right: Parser accepts input</a></th>
        <td><a href="#slide8">8</a></td>
      </tr>
      
      
      <tr id="toc-row-9">
        <th><a href="#slide9">A <code>Parser</code> Primitive</a></th>
        <td><a href="#slide9">9</a></td>
      </tr>
      
      
      <tr id="toc-row-10">
        <th><a href="#slide10"><code>run</code></a></th>
        <td><a href="#slide10">10</a></td>
      </tr>
      
      
      <tr id="toc-row-11">
        <th><a href="#slide11">-</a></th>
        <td><a href="#slide11">11</a></td>
      </tr>
      
      
      <tr id="toc-row-12">
        <th><a href="#slide12">-</a></th>
        <td><a href="#slide12">12</a></td>
      </tr>
      
      
      <tr id="toc-row-13">
        <th><a href="#slide13">Compatibility with Scala's <a href="http://www.scala-lang.org/api/2.11.8/#scala.util.matching.Regex"><code>Regex</code></a> type</a></th>
        <td><a href="#slide13">13</a></td>
      </tr>
      
      
      <tr id="toc-row-14">
        <th><a href="#slide14">Compatibility with Scala's <code>Regex</code> type</a></th>
        <td><a href="#slide14">14</a></td>
      </tr>
      
      
      <tr id="toc-row-15">
        <th><a href="#slide15">How to combine <code>detectFoo</code> and <code>eof</code>?</a></th>
        <td><a href="#slide15">15</a></td>
      </tr>
      
      
      <tr id="toc-row-16">
        <th><a href="#slide16"><code>product</code></a></th>
        <td><a href="#slide16">16</a></td>
      </tr>
      
      
      <tr id="toc-row-17">
        <th><a href="#slide17">-</a></th>
        <td><a href="#slide17">17</a></td>
      </tr>
      
      
      <tr id="toc-row-18">
        <th><a href="#slide18">Rejection</a></th>
        <td><a href="#slide18">18</a></td>
      </tr>
      
      
      <tr id="toc-row-19">
        <th><a href="#slide19">Combinators</a></th>
        <td><a href="#slide19">19</a></td>
      </tr>
      
      
      <tr id="toc-row-20">
        <th><a href="#slide20">Analogies to <code>Rand</code></a></th>
        <td><a href="#slide20">20</a></td>
      </tr>
      
      
      <tr id="toc-row-21">
        <th><a href="#slide21">Analogies to <code>Rand</code></a></th>
        <td><a href="#slide21">21</a></td>
      </tr>
      
      
      <tr id="toc-row-22">
        <th><a href="#slide22">-</a></th>
        <td><a href="#slide22">22</a></td>
      </tr>
      
      
      <tr id="toc-row-23">
        <th><a href="#slide23">-</a></th>
        <td><a href="#slide23">23</a></td>
      </tr>
      
      
      <tr id="toc-row-24">
        <th><a href="#slide24">or</a></th>
        <td><a href="#slide24">24</a></td>
      </tr>
      
      
      <tr id="toc-row-25">
        <th><a href="#slide25">Tokens</a></th>
        <td><a href="#slide25">25</a></td>
      </tr>
      
      
      <tr id="toc-row-26">
        <th><a href="#slide26">Grammar</a></th>
        <td><a href="#slide26">26</a></td>
      </tr>
      
      
      <tr id="toc-row-27">
        <th><a href="#slide27">-</a></th>
        <td><a href="#slide27">27</a></td>
      </tr>
      
      
      <tr id="toc-row-28">
        <th><a href="#slide28">Another grammar, another set of Tokens</a></th>
        <td><a href="#slide28">28</a></td>
      </tr>
      
      
      <tr id="toc-row-29">
        <th><a href="#slide29">Grammar</a></th>
        <td><a href="#slide29">29</a></td>
      </tr>
      
      
      <tr id="toc-row-30">
        <th><a href="#slide30">More prerequisite combinators</a></th>
        <td><a href="#slide30">30</a></td>
      </tr>
      
      
      <tr id="toc-row-31">
        <th><a href="#slide31">More prerequisite combinators</a></th>
        <td><a href="#slide31">31</a></td>
      </tr>
      
      
      <tr id="toc-row-32">
        <th><a href="#slide32">-</a></th>
        <td><a href="#slide32">32</a></td>
      </tr>
      
      
      <tr id="toc-row-33">
        <th><a href="#slide33">-</a></th>
        <td><a href="#slide33">33</a></td>
      </tr>
      
      
      <tr id="toc-row-34">
        <th><a href="#slide34">Conclusion</a></th>
        <td><a href="#slide34">34</a></td>
      </tr>
      
      
      <tr id="toc-row-35">
        <th><a href="#slide35">Chapter comments</a></th>
        <td><a href="#slide35">35</a></td>
      </tr>
      
      
      <tr id="toc-row-36">
        <th><a href="#slide36">-</a></th>
        <td><a href="#slide36">36</a></td>
      </tr>
      
      
    </table>
  </div>
  
  <div id="help" class="sidebar hidden">
    <h2>Help</h2>
    <table>
      <caption>Help</caption>
      <tr>
        <th>Table of Contents</th>
        <td>t</td>
      </tr>
      <tr>
        <th>Exposé</th>
        <td>ESC</td>
      </tr>
      <tr>
        <th>Full screen slides</th>
        <td>e</td>
      </tr>
      <tr>
        <th>Presenter View</th>
        <td>p</td>
      </tr>
      <tr>
        <th>Source Files</th>
        <td>s</td>
      </tr>
      <tr>
        <th>Slide Numbers</th>
        <td>n</td>
      </tr>
      <tr>
        <th>Toggle screen blanking</th>
        <td>b</td>
      </tr>
      <tr>
        <th>Show/hide slide context</th>
        <td>c</td>
      </tr>
      <tr>
        <th>Notes</th>
        <td>2</td>
      </tr>
      <tr>
        <th>Help</th>
        <td>h</td>
      </tr>
    </table>
  </div>
  <script>main()</script>
</body>
</html>